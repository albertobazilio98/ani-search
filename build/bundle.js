var app=function(){"use strict";function e(){}function t(e){return e()}function n(){return Object.create(null)}function r(e){e.forEach(t)}function i(e){return"function"==typeof e}function s(e,t){return e!=e?t==t:e!==t||e&&"object"==typeof e||"function"==typeof e}let o,c;function l(e,t){return o||(o=document.createElement("a")),o.href=t,e===o.href}function u(e){return null==e?"":e}function a(e,t){e.appendChild(t)}function d(e,t,n){e.insertBefore(t,n||null)}function f(e){e.parentNode&&e.parentNode.removeChild(e)}function p(e){return document.createElement(e)}function v(e){return document.createElementNS("http://www.w3.org/2000/svg",e)}function h(e){return document.createTextNode(e)}function m(){return h(" ")}function $(e,t,n,r){return e.addEventListener(t,n,r),()=>e.removeEventListener(t,n,r)}function g(e,t,n){null==n?e.removeAttribute(t):e.getAttribute(t)!==n&&e.setAttribute(t,n)}function w(e,t){t=""+t,e.data!==t&&(e.data=t)}function x(e,t){e.value=null==t?"":t}function y(e){c=e}function b(){const e=function(){if(!c)throw new Error("Function called outside component initialization");return c}();return(t,n,{cancelable:r=!1}={})=>{const i=e.$$.callbacks[t];if(i){const s=function(e,t,{bubbles:n=!1,cancelable:r=!1}={}){const i=document.createEvent("CustomEvent");return i.initCustomEvent(e,n,r,t),i}(t,n,{cancelable:r});return i.slice().forEach((t=>{t.call(e,s)})),!s.defaultPrevented}return!0}}const j=[],z=[];let L=[];const k=[],_=Promise.resolve();let E=!1;function q(e){L.push(e)}const B=new Set;let U=0;function C(){if(0!==U)return;const e=c;do{try{for(;U<j.length;){const e=j[U];U++,y(e),R(e.$$)}}catch(e){throw j.length=0,U=0,e}for(y(null),j.length=0,U=0;z.length;)z.pop()();for(let e=0;e<L.length;e+=1){const t=L[e];B.has(t)||(B.add(t),t())}L.length=0}while(j.length);for(;k.length;)k.pop()();E=!1,B.clear(),y(e)}function R(e){if(null!==e.fragment){e.update(),r(e.before_update);const t=e.dirty;e.dirty=[-1],e.fragment&&e.fragment.p(e.ctx,t),e.after_update.forEach(q)}}const O=new Set;let S;function A(){S={r:0,c:[],p:S}}function M(){S.r||r(S.c),S=S.p}function H(e,t){e&&e.i&&(O.delete(e),e.i(t))}function T(e,t,n,r){if(e&&e.o){if(O.has(e))return;O.add(e),S.c.push((()=>{O.delete(e),r&&(n&&e.d(1),r())})),e.o(t)}else r&&r()}function D(e){e&&e.c()}function N(e,n,s,o){const{fragment:c,after_update:l}=e.$$;c&&c.m(n,s),o||q((()=>{const n=e.$$.on_mount.map(t).filter(i);e.$$.on_destroy?e.$$.on_destroy.push(...n):r(n),e.$$.on_mount=[]})),l.forEach(q)}function P(e,t){const n=e.$$;null!==n.fragment&&(!function(e){const t=[],n=[];L.forEach((r=>-1===e.indexOf(r)?t.push(r):n.push(r))),n.forEach((e=>e())),L=t}(n.after_update),r(n.on_destroy),n.fragment&&n.fragment.d(t),n.on_destroy=n.fragment=null,n.ctx=[])}function V(e,t){-1===e.$$.dirty[0]&&(j.push(e),E||(E=!0,_.then(C)),e.$$.dirty.fill(0)),e.$$.dirty[t/31|0]|=1<<t%31}function F(t,i,s,o,l,u,a,d=[-1]){const p=c;y(t);const v=t.$$={fragment:null,ctx:[],props:u,update:e,not_equal:l,bound:n(),on_mount:[],on_destroy:[],on_disconnect:[],before_update:[],after_update:[],context:new Map(i.context||(p?p.$$.context:[])),callbacks:n(),dirty:d,skip_bound:!1,root:i.target||p.$$.root};a&&a(v.root);let h=!1;if(v.ctx=s?s(t,i.props||{},((e,n,...r)=>{const i=r.length?r[0]:n;return v.ctx&&l(v.ctx[e],v.ctx[e]=i)&&(!v.skip_bound&&v.bound[e]&&v.bound[e](i),h&&V(t,e)),n})):[],v.update(),h=!0,r(v.before_update),v.fragment=!!o&&o(v.ctx),i.target){if(i.hydrate){const e=function(e){return Array.from(e.childNodes)}(i.target);v.fragment&&v.fragment.l(e),e.forEach(f)}else v.fragment&&v.fragment.c();i.intro&&H(t.$$.fragment),N(t,i.target,i.anchor,i.customElement),C()}y(p)}class I{$destroy(){P(this,1),this.$destroy=e}$on(t,n){if(!i(n))return e;const r=this.$$.callbacks[t]||(this.$$.callbacks[t]=[]);return r.push(n),()=>{const e=r.indexOf(n);-1!==e&&r.splice(e,1)}}$set(e){var t;this.$$set&&(t=e,0!==Object.keys(t).length)&&(this.$$.skip_bound=!0,this.$$set(e),this.$$.skip_bound=!1)}}function Z(t){let n,r;return{c(){n=v("svg"),r=v("path"),g(r,"d","M9,16V10H5L12,3L19,10H15V16H9M5,20V18H19V20H5Z"),g(r,"fill",t[2]),g(n,"width",t[0]),g(n,"height",t[1]),g(n,"viewBox",t[3])},m(e,t){d(e,n,t),a(n,r)},p(e,[t]){4&t&&g(r,"fill",e[2]),1&t&&g(n,"width",e[0]),2&t&&g(n,"height",e[1]),8&t&&g(n,"viewBox",e[3])},i:e,o:e,d(e){e&&f(n)}}}function G(e,t,n){let{size:r="1em"}=t,{width:i=r}=t,{height:s=r}=t,{color:o="currentColor"}=t,{viewBox:c="0 0 24 24"}=t;return e.$$set=e=>{"size"in e&&n(4,r=e.size),"width"in e&&n(0,i=e.width),"height"in e&&n(1,s=e.height),"color"in e&&n(2,o=e.color),"viewBox"in e&&n(3,c=e.viewBox)},[i,s,o,c,r]}class J extends I{constructor(e){super(),F(this,e,G,Z,s,{size:4,width:0,height:1,color:2,viewBox:3})}}function K(e){let t,n,i,s,o,c,l,v,h,w,x,y;return c=new J({props:{size:"8rem",color:"#404040"}}),{c(){t=p("div"),n=p("input"),i=m(),s=p("label"),o=p("div"),D(c.$$.fragment),l=m(),v=p("div"),v.textContent="drag 'n drop zone",g(n,"type","file"),g(n,"class","invisible-input svelte-9jgcjz"),g(n,"id","imageInput"),g(v,"class","text svelte-9jgcjz"),g(o,"class",""),g(s,"for","imageInput"),g(s,"class","container svelte-9jgcjz"),g(t,"class",h=u(e[0])+" svelte-9jgcjz")},m(r,u){d(r,t,u),a(t,n),a(t,i),a(t,s),a(s,o),N(c,o,null),a(o,l),a(o,v),w=!0,x||(y=[$(n,"change",e[3]),$(t,"drop",e[1]),$(t,"dragover",Q),$(t,"dragover",e[4]),$(t,"dragleave",e[5])],x=!0)},p(e,[n]){(!w||1&n&&h!==(h=u(e[0])+" svelte-9jgcjz"))&&g(t,"class",h)},i(e){w||(H(c.$$.fragment,e),w=!0)},o(e){T(c.$$.fragment,e),w=!1},d(e){e&&f(t),P(c),x=!1,r(y)}}}function Q(e){e.preventDefault()}function W(e,t,n){let r,i="drop-zone";const s=b();function o(){r&&s("fileUploaded",r)}function c(e){n(0,i=e?"drop-zone active":"drop-zone")}return[i,async function(e){e.preventDefault(),c(!1),function(e){var t;e.dataTransfer.items?"file"===(null===(t=e.dataTransfer.items[0])||void 0===t?void 0:t.kind)&&(r=e.dataTransfer.items[0].getAsFile()):r=e.dataTransfer.files[0]}(e),o(),(new FormData).append("image",r)},c,function(e){r=e.target.files[0],o()},()=>c(!0),()=>c(!1)]}class X extends I{constructor(e){super(),F(this,e,W,K,s,{})}}function Y(t){let n;return{c(){n=p("div"),n.innerHTML='<div class="spinner-ring svelte-1j4qdpv"></div> \n  <div class="spinner-ring svelte-1j4qdpv"></div> \n  <div class="spinner-ring svelte-1j4qdpv"></div> \n  <div class="spinner-ring svelte-1j4qdpv"></div> \n  <div class="spinner-ring svelte-1j4qdpv"></div> \n  <div class="spinner-ring svelte-1j4qdpv"></div> \n  <div class="spinner-ring svelte-1j4qdpv"></div> \n  <div class="spinner-ring svelte-1j4qdpv"></div> \n  <div class="spinner-ring svelte-1j4qdpv"></div>',g(n,"class","fingerprint-spinner svelte-1j4qdpv")},m(e,t){d(e,n,t)},p:e,i:e,o:e,d(e){e&&f(n)}}}class ee extends I{constructor(e){super(),F(this,e,null,Y,s,{})}}function te(t){let n,r;return{c(){n=v("svg"),r=v("path"),g(r,"d","M9.5,3A6.5,6.5 0 0,1 16,9.5C16,11.11 15.41,12.59 14.44,13.73L14.71,14H15.5L20.5,19L19,20.5L14,15.5V14.71L13.73,14.44C12.59,15.41 11.11,16 9.5,16A6.5,6.5 0 0,1 3,9.5A6.5,6.5 0 0,1 9.5,3M9.5,5C7,5 5,7 5,9.5C5,12 7,14 9.5,14C12,14 14,12 14,9.5C14,7 12,5 9.5,5Z"),g(r,"fill",t[2]),g(n,"width",t[0]),g(n,"height",t[1]),g(n,"viewBox",t[3])},m(e,t){d(e,n,t),a(n,r)},p(e,[t]){4&t&&g(r,"fill",e[2]),1&t&&g(n,"width",e[0]),2&t&&g(n,"height",e[1]),8&t&&g(n,"viewBox",e[3])},i:e,o:e,d(e){e&&f(n)}}}function ne(e,t,n){let{size:r="1em"}=t,{width:i=r}=t,{height:s=r}=t,{color:o="currentColor"}=t,{viewBox:c="0 0 24 24"}=t;return e.$$set=e=>{"size"in e&&n(4,r=e.size),"width"in e&&n(0,i=e.width),"height"in e&&n(1,s=e.height),"color"in e&&n(2,o=e.color),"viewBox"in e&&n(3,c=e.viewBox)},[i,s,o,c,r]}class re extends I{constructor(e){super(),F(this,e,ne,te,s,{size:4,width:0,height:1,color:2,viewBox:3})}}function ie(e){let t,n,i,s,o,c,l,u;return o=new re({props:{size:"1.75rem"}}),{c(){t=p("div"),n=p("input"),i=m(),s=p("div"),D(o.$$.fragment),g(n,"type","url"),g(n,"class","input svelte-53uefq"),g(n,"placeholder","Or paste the screenshot url here"),g(s,"class","magnifier svelte-53uefq"),g(t,"class","search-bar svelte-53uefq")},m(r,f){d(r,t,f),a(t,n),x(n,e[0]),a(t,i),a(t,s),N(o,s,null),c=!0,l||(u=[$(n,"input",e[2]),$(s,"click",e[1])],l=!0)},p(e,[t]){1&t&&n.value!==e[0]&&x(n,e[0])},i(e){c||(H(o.$$.fragment,e),c=!0)},o(e){T(o.$$.fragment,e),c=!1},d(e){e&&f(t),P(o),l=!1,r(u)}}}function se(e,t,n){let r;const i=b();return[r,function(){r&&i("submitedURL",r)},function(){r=this.value,n(0,r)}]}class oe extends I{constructor(e){super(),F(this,e,se,ie,s,{})}}const ce="https://api.trace.moe/";async function le({querystring:e,formData:t}){return(await fetch(`${ce}search?${e}`,{method:"POST",body:t})).json()}function ue(t){let n,r,i,s;return{c(){n=p("img"),g(n,"class","preview svelte-1f59kil"),l(n.src,r=t[1]())||g(n,"src",r)},m(e,r){d(e,n,r),i||(s=$(n,"click",t[4]),i=!0)},p(e,t){2&t&&!l(n.src,r=e[1]())&&g(n,"src",r)},i:e,o:e,d(e){e&&f(n),i=!1,s()}}}function ae(t){let n,r,i,s;return n=new oe({}),n.$on("submitedURL",t[3]),i=new X({}),i.$on("fileUploaded",t[2]),{c(){D(n.$$.fragment),r=m(),D(i.$$.fragment)},m(e,t){N(n,e,t),d(e,r,t),N(i,e,t),s=!0},p:e,i(e){s||(H(n.$$.fragment,e),H(i.$$.fragment,e),s=!0)},o(e){T(n.$$.fragment,e),T(i.$$.fragment,e),s=!1},d(e){P(n,e),e&&f(r),P(i,e)}}}function de(e){let t,n;return t=new ee({}),{c(){D(t.$$.fragment)},m(e,r){N(t,e,r),n=!0},i(e){n||(H(t.$$.fragment,e),n=!0)},o(e){T(t.$$.fragment,e),n=!1},d(e){P(t,e)}}}function fe(e){let t,n,r,i,s,o,c=e[1]()&&!e[0];const l=[ae,ue],u=[];function v(e,t){return 2&t&&(n=null),null==n&&(n=!e[1]()),n?0:1}r=v(e,-1),i=u[r]=l[r](e);let h=c&&de();return{c(){t=p("div"),i.c(),s=m(),h&&h.c(),g(t,"class","search svelte-1f59kil")},m(e,n){d(e,t,n),u[r].m(t,null),a(t,s),h&&h.m(t,null),o=!0},p(e,[n]){let o=r;r=v(e,n),r===o?u[r].p(e,n):(A(),T(u[o],1,1,(()=>{u[o]=null})),M(),i=u[r],i?i.p(e,n):(i=u[r]=l[r](e),i.c()),H(i,1),i.m(t,s)),3&n&&(c=e[1]()&&!e[0]),c?h?3&n&&H(h,1):(h=de(),h.c(),H(h,1),h.m(t,null)):h&&(A(),T(h,1,1,(()=>{h=null})),M())},i(e){o||(H(i),H(h),o=!0)},o(e){T(i),T(h),o=!1},d(e){e&&f(t),u[r].d(),h&&h.d()}}}function pe(e,t,n){let r,i,s,{response:o}=t;return e.$$set=e=>{"response"in e&&n(0,o=e.response)},e.$$.update=()=>{96&e.$$.dirty&&n(1,r=()=>i?URL.createObjectURL(i):s||void 0)},[o,r,async function(e){n(5,i=e.detail),n(0,o=await async function({image:e,params:t}){const n=new FormData;n.append("image",e);const r=new URLSearchParams("cutBorders=true");return t&&Object.entries(t).forEach((e=>r.append(...e))),await le({querystring:r.toString(),formData:n})}({image:i}))},async function(e){n(6,s=e.detail),n(0,o=await async function(e){const t=new URLSearchParams("cutBorders=true");return Object.entries(e).forEach((e=>t.append(...e))),await le({querystring:t.toString()})}({url:s}))},function(){n(5,i=null),n(6,s=null),n(0,o=null)},i,s]}class ve extends I{constructor(e){super(),F(this,e,pe,fe,s,{response:0})}}function he(t){let n,i,s,o,c;return{c(){n=p("div"),i=p("video"),l(i.src,s=t[0])||g(i,"src",s),g(i,"class","svelte-10vztb3"),g(n,"class","video svelte-10vztb3")},m(e,t){d(e,n,t),a(n,i),o||(c=[$(i,"mouseover",me),$(i,"mouseleave",$e),$(i,"focus",me),$(i,"focusout",$e)],o=!0)},p(e,[t]){1&t&&!l(i.src,s=e[0])&&g(i,"src",s)},i:e,o:e,d(e){e&&f(n),o=!1,r(c)}}}function me(e){e.target.play()}function $e(e){e.target.pause()}function ge(e,t,n){let{videoURL:r}=t;return e.$$set=e=>{"videoURL"in e&&n(0,r=e.videoURL)},[r]}class we extends I{constructor(e){super(),F(this,e,ge,he,s,{videoURL:0})}}function xe(e,t,n){const r=e.slice();return r[2]=t[n],r}function ye(e){let t,n,r,i,s,o,c,l,u,v,$,x,y,b,j,z,L,k,_=e[2].filename+"",E=e[2].episode+"",q=Math.round(1e4*e[2].similarity)/100+"";return n=new we({props:{videoURL:e[2].video}}),{c(){t=p("div"),D(n.$$.fragment),r=m(),i=p("div"),s=p("a"),o=h(_),l=m(),u=p("div"),v=h("episode "),$=h(E),x=m(),y=p("div"),b=h("assurance: "),j=h(q),z=h("%"),L=m(),g(s,"href",c="https://anilist.co/anime/"+e[2].anilist),g(s,"class","name svelte-9xyk0n"),g(s,"target","blank"),g(u,"class","episode-number svelte-9xyk0n"),g(y,"class","assurance svelte-9xyk0n"),g(i,"class","info svelte-9xyk0n"),g(t,"class","result-item svelte-9xyk0n")},m(e,c){d(e,t,c),N(n,t,null),a(t,r),a(t,i),a(i,s),a(s,o),a(i,l),a(i,u),a(u,v),a(u,$),a(i,x),a(i,y),a(y,b),a(y,j),a(y,z),a(t,L),k=!0},p(e,t){const r={};1&t&&(r.videoURL=e[2].video),n.$set(r),(!k||1&t)&&_!==(_=e[2].filename+"")&&w(o,_),(!k||1&t&&c!==(c="https://anilist.co/anime/"+e[2].anilist))&&g(s,"href",c),(!k||1&t)&&E!==(E=e[2].episode+"")&&w($,E),(!k||1&t)&&q!==(q=Math.round(1e4*e[2].similarity)/100+"")&&w(j,q)},i(e){k||(H(n.$$.fragment,e),k=!0)},o(e){T(n.$$.fragment,e),k=!1},d(e){e&&f(t),P(n)}}}function be(e){let t,n,r=e[0](),i=[];for(let t=0;t<r.length;t+=1)i[t]=ye(xe(e,r,t));const s=e=>T(i[e],1,1,(()=>{i[e]=null}));return{c(){t=p("div");for(let e=0;e<i.length;e+=1)i[e].c();g(t,"class","result-list svelte-9xyk0n")},m(e,r){d(e,t,r);for(let e=0;e<i.length;e+=1)i[e]&&i[e].m(t,null);n=!0},p(e,[n]){if(1&n){let o;for(r=e[0](),o=0;o<r.length;o+=1){const s=xe(e,r,o);i[o]?(i[o].p(s,n),H(i[o],1)):(i[o]=ye(s),i[o].c(),H(i[o],1),i[o].m(t,null))}for(A(),o=r.length;o<i.length;o+=1)s(o);M()}},i(e){if(!n){for(let e=0;e<r.length;e+=1)H(i[e]);n=!0}},o(e){i=i.filter(Boolean);for(let e=0;e<i.length;e+=1)T(i[e]);n=!1},d(e){e&&f(t),function(e,t){for(let n=0;n<e.length;n+=1)e[n]&&e[n].d(t)}(i,e)}}}function je(e,t,n){let r,{results:i}=t;return e.$$set=e=>{"results"in e&&n(1,i=e.results)},e.$$.update=()=>{2&e.$$.dirty&&n(0,r=()=>[...new Set(i.map((e=>e.anilist)))].slice(0,3).map((e=>i.find((t=>t.anilist===e)))))},[r,i]}class ze extends I{constructor(e){super(),F(this,e,je,be,s,{results:1})}}function Le(e){let t,n;return t=new ze({props:{results:e[0].result}}),{c(){D(t.$$.fragment)},m(e,r){N(t,e,r),n=!0},p(e,n){const r={};1&n&&(r.results=e[0].result),t.$set(r)},i(e){n||(H(t.$$.fragment,e),n=!0)},o(e){T(t.$$.fragment,e),n=!1},d(e){P(t,e)}}}function ke(e){let t,n,r,i,s,o,c;function l(t){e[1](t)}let u={};void 0!==e[0]&&(u.response=e[0]),i=new ve({props:u}),z.push((()=>function(e,t,n){const r=e.$$.props[t];void 0!==r&&(e.$$.bound[r]=n,n(e.$$.ctx[r]))}(i,"response",l)));let v=e[0]&&!e[0].error&&Le(e);return{c(){t=p("main"),n=p("h1"),n.textContent="Upload an anime screenshot to find out which anime and episode it belongs to",r=m(),D(i.$$.fragment),o=m(),v&&v.c(),g(n,"class","svelte-1x8xzvw"),g(t,"class","svelte-1x8xzvw")},m(e,s){d(e,t,s),a(t,n),a(t,r),N(i,t,null),a(t,o),v&&v.m(t,null),c=!0},p(e,[n]){const r={};var o;!s&&1&n&&(s=!0,r.response=e[0],o=()=>s=!1,k.push(o)),i.$set(r),e[0]&&!e[0].error?v?(v.p(e,n),1&n&&H(v,1)):(v=Le(e),v.c(),H(v,1),v.m(t,null)):v&&(A(),T(v,1,1,(()=>{v=null})),M())},i(e){c||(H(i.$$.fragment,e),H(v),c=!0)},o(e){T(i.$$.fragment,e),T(v),c=!1},d(e){e&&f(t),P(i),v&&v.d()}}}function _e(e,t,n){let r;return[r,function(e){r=e,n(0,r)}]}return new class extends I{constructor(e){super(),F(this,e,_e,ke,s,{})}}({target:document.body})}();
//# sourceMappingURL=bundle.js.map
